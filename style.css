:root {
  --orange:#ffb16f;
  --orange-dark:#ff8f3b;
  --orange-light:#ffd6b0;
  --bg:#ffffff;
  --bg-muted:#f7f7f7;
  --border:#e4e4e7;
  --border-strong:#d4d4d8;
  --text:#1f2933;
  --text-muted:#6b7280;
  --text-inverse:#ffffff;
  --shadow:0 12px 32px rgba(15,23,42,0.12);
  --radius-lg:16px;
  --radius-md:12px;
  --radius-sm:8px;
  --badge-bg:rgba(255,255,255,0.18);
  --badge-border:rgba(255,255,255,0.3);
  --card-bg:#ffffff;
  --accent:#2563eb;
  font-family:"Segoe UI", "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Helvetica Neue", Arial, sans-serif;
}

body {
  margin:0;
  background:linear-gradient(180deg,#fff 0%,#fff9f3 100%);
  color:var(--text);
}

.app-root {
  min-height:100vh;
  display:flex;
  flex-direction:column;
}

.app-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:24px clamp(16px,6vw,40px);
  background:linear-gradient(90deg,var(--orange),var(--orange-dark));
  color:var(--text-inverse);
  gap:24px;
}

.header-left {
  display:flex;
  align-items:center;
  gap:16px;
  flex:1;
}

.logo {
  width:56px;
  height:56px;
  border-radius:14px;
  background:rgba(255,255,255,0.18);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:700;
  font-size:22px;
  box-shadow:0 12px 28px rgba(0,0,0,0.14);
}

.title-group {
  display:flex;
  flex-direction:column;
  gap:6px;
}

.app-title {
  margin:0;
  font-size:clamp(20px,2.2vw,28px);
  letter-spacing:0.01em;
}

.app-subtitle {
  margin:0;
  font-size:13px;
  max-width:540px;
  line-height:1.5;
  opacity:0.95;
}

.header-right {
  display:flex;
  align-items:flex-start;
  gap:12px;
  flex-wrap:wrap;
}

.badge-stack {
  display:flex;
  flex-direction:column;
  gap:6px;
  min-width:0;
}

.badge {
  display:inline-flex;
  align-items:center;
  gap:6px;
  padding:6px 12px;
  border-radius:999px;
  background:var(--badge-bg);
  border:1px solid var(--badge-border);
  font-size:12px;
  letter-spacing:0.06em;
  text-transform:uppercase;
}

.badge-value {
  font-weight:600;
}

.badge-link {
  font-size:12px;
  font-weight:600;
  color:var(--accent);
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  gap:4px;
}

.badge-link:focus-visible,
.badge-link:hover {
  text-decoration:underline;
}

.badge-link[aria-disabled="true"] {
  pointer-events:none;
  opacity:0.6;
  text-decoration:none;
}

.badge-subtext {
  font-size:11px;
  color:var(--text-muted);
  display:flex;
  align-items:center;
  gap:6px;
  letter-spacing:0.02em;
}

.badge-subtext-label {
  font-weight:600;
  text-transform:uppercase;
  letter-spacing:0.08em;
}

.badge-subtext time {
  font-variant-numeric:tabular-nums;
}

.rate-meta {
  margin-top:8px;
  flex-wrap:wrap;
  gap:12px;
}

.rate-meta-item {
  display:inline-flex;
  align-items:center;
  gap:6px;
}

.rate-meta-item time {
  font-variant-numeric:tabular-nums;
}

.ghost-button,
.primary-button,
.secondary-button {
  border-radius:999px;
  border:1px solid transparent;
  font-weight:600;
  font-size:13px;
  padding:8px 16px;
  cursor:pointer;
  transition:transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease, color 0.15s ease;
}

.primary-button {
  background:var(--orange);
  color:var(--text-inverse);
  border-color:rgba(255,255,255,0.3);
}

.primary-button:hover { background:var(--orange-dark); }

.secondary-button {
  background:rgba(37,99,235,0.08);
  color:var(--accent);
  border-color:rgba(37,99,235,0.24);
}

.secondary-button:hover {
  background:rgba(37,99,235,0.16);
}

.app-header .secondary-button {
  background:rgba(255,255,255,0.16);
  color:var(--text-inverse);
  border-color:rgba(255,255,255,0.35);
}

.app-header .secondary-button:hover {
  background:rgba(255,255,255,0.32);
}

.ghost-button {
  background:transparent;
  color:inherit;
  border-color:rgba(255,255,255,0.35);
}

.ghost-button:hover {
  background:rgba(255,255,255,0.18);
}

.app-main {
  flex:1;
  padding:26px clamp(16px,5vw,44px);
}

.banner-container {
  display:flex;
  flex-direction:column;
  gap:12px;
  margin-bottom:20px;
}

.banner {
  display:flex;
  gap:16px;
  align-items:flex-start;
  padding:14px 18px;
  border-radius:var(--radius-md);
  border:1px solid transparent;
  background:var(--card-bg);
  box-shadow:var(--shadow);
}

.banner-icon {
  font-size:18px;
  line-height:1;
}

.banner-message {
  flex:1;
  font-size:14px;
  line-height:1.5;
  white-space:pre-line;
}

.banner-close {
  background:none;
  border:none;
  color:inherit;
  cursor:pointer;
  font-weight:600;
  padding:0;
}

.banner-error { border-color:#ef4444; background:#fee2e2; color:#7f1d1d; }
.banner-warning { border-color:#f97316; background:#fff7ed; color:#7c2d12; }
.banner-info { border-color:#2563eb; background:#eff6ff; color:#1d4ed8; }
.banner-success { border-color:#16a34a; background:#dcfce7; color:#166534; }

.layout-grid {
  display:grid;
  grid-template-columns:repeat(12,1fr);
  gap:24px;
}

.panel {
  background:var(--card-bg);
  border-radius:var(--radius-lg);
  box-shadow:var(--shadow);
  padding:24px;
  display:flex;
  flex-direction:column;
  gap:22px;
}

.panel-input { grid-column:span 6; }
.panel-results { grid-column:span 6; }

.section-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:16px;
}

.section-header.is-static {
  justify-content:flex-start;
}

.section-title {
  margin:0;
  font-size:16px;
  font-weight:600;
}

.field-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:14px 16px;
}

.field-stack {
  display:flex;
  flex-direction:column;
  gap:18px;
}

.field-group {
  display:flex;
  flex-direction:column;
  gap:12px;
  padding:16px;
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  background:var(--bg);
  box-shadow:0 8px 24px rgba(15,23,42,0.04);
}

.field-group-header {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:8px;
}

.field-group-title {
  font-size:14px;
  font-weight:600;
  color:var(--text);
}

.field-group-body {
  display:flex;
  flex-direction:column;
  gap:12px;
}

.field-help {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:20px;
  height:20px;
  border-radius:999px;
  border:1px solid var(--border);
  background:var(--bg-muted);
  color:var(--text-muted);
  font-size:12px;
  font-weight:600;
  cursor:help;
  flex-shrink:0;
}

.field-help:hover {
  color:var(--text);
}

.field-note {
  margin:0;
  font-size:12px;
  color:var(--text-muted);
}

.form-field {
  display:flex;
  flex-direction:column;
  gap:6px;
  font-size:13px;
  color:var(--text-muted);
}

.field-combo {
  display:flex;
  align-items:center;
  gap:8px;
}

.field-combo .form-control {
  flex:1 1 auto;
}

.hours-preset-select {
  flex:0 0 auto;
  min-width:140px;
}

@media (max-width:600px) {
  .field-combo {
    flex-wrap:wrap;
  }

  .hours-preset-select {
    flex:1 1 160px;
  }
}

.form-control {
  border-radius:var(--radius-md);
  border:1px solid var(--border);
  padding:10px 12px;
  font-size:14px;
  background:var(--bg);
  color:var(--text);
  transition:border-color 0.2s ease, box-shadow 0.2s ease;
}

.form-control:focus {
  outline:none;
  border-color:var(--accent);
  box-shadow:0 0 0 2px rgba(37,99,235,0.2);
}

.form-control.is-invalid {
  border-color:#ef4444;
  box-shadow:0 0 0 2px rgba(239,68,68,0.2);
}

.field-error {
  min-height:18px;
  font-size:12px;
  color:#b91c1c;
}

.tab-list {
  display:inline-flex;
  background:var(--bg-muted);
  padding:4px;
  border-radius:999px;
  gap:4px;
}

.tab-button {
  border:none;
  border-radius:999px;
  padding:6px 14px;
  font-size:13px;
  cursor:pointer;
  background:transparent;
  color:var(--text-muted);
  transition:all 0.2s ease;
}

.tab-button.is-active {
  background:var(--bg);
  color:var(--text);
  box-shadow:0 4px 14px rgba(15,23,42,0.1);
}

.tab-panel {
  display:block;
}

.tab-panel[hidden] {
  display:none;
}

.switch {
  position:relative;
  width:44px;
  height:24px;
  display:inline-flex;
}

.switch input {
  opacity:0;
  width:0;
  height:0;
}

.switch-slider {
  position:absolute;
  inset:0;
  background:#d1d5db;
  border-radius:999px;
  transition:background 0.2s ease;
}

.switch-slider::after {
  content:"";
  position:absolute;
  width:20px;
  height:20px;
  background:#ffffff;
  border-radius:50%;
  top:2px;
  left:2px;
  transition:transform 0.2s ease;
  box-shadow:0 4px 10px rgba(15,23,42,0.2);
}

.switch input:checked + .switch-slider {
  background:var(--orange);
}

.switch input:checked + .switch-slider::after {
  transform:translateX(20px);
}

.switch-field {
  flex-direction:row;
  justify-content:space-between;
  align-items:center;
}

.sensitivity-controls {
  display:flex;
  flex-direction:column;
  gap:14px;
  opacity:0.6;
  pointer-events:none;
  transition:opacity 0.2s ease;
}

.sensitivity-controls.is-enabled {
  opacity:1;
  pointer-events:auto;
}

.sensitivity-row {
  display:grid;
  grid-template-columns:120px 1fr 72px 24px;
  gap:12px;
  align-items:center;
  font-size:13px;
}

.sensitivity-input {
  width:100%;
  border-radius:var(--radius-sm);
  border:1px solid var(--border);
  padding:6px 8px;
  text-align:center;
}

.panel-section {
  background:rgba(248,249,252,0.6);
  border-radius:var(--radius-md);
  padding:0;
  border:1px solid rgba(229,231,235,0.6);
  overflow:hidden;
}

.panel-section + .panel-section {
  margin-top:8px;
}

[data-collapsible] .section-header {
  margin-bottom:0;
  padding:14px 18px;
}

[data-collapsible] .section-body {
  padding:0 18px 18px;
  display:flex;
  flex-direction:column;
  gap:16px;
}

[data-collapsible].is-collapsed .section-body {
  display:none;
}

.section-toggle {
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  width:100%;
  flex:1;
  background:none;
  border:none;
  padding:0;
  margin:0;
  font:inherit;
  color:inherit;
  cursor:pointer;
}

.section-toggle:focus-visible {
  outline:2px solid var(--accent);
  outline-offset:2px;
}

.section-toggle-icon {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:22px;
  height:22px;
  border-radius:999px;
  border:1px solid var(--border);
  background:rgba(255,255,255,0.6);
  color:var(--text-muted);
  transition:transform 0.2s ease;
}

.section-toggle-icon::before {
  content:'▾';
  font-size:12px;
  line-height:1;
  transition:transform 0.2s ease;
}

[data-collapsible].is-collapsed .section-toggle-icon::before {
  transform:rotate(-90deg);
}

.section-controls {
  display:flex;
  align-items:center;
  gap:12px;
}

.scenario-controls {
  display:flex;
  flex-direction:column;
  gap:12px;
}

.scenario-buttons {
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}

.help-intro {
  margin-top:0;
}

.help-list {
  margin:12px 0 0;
  padding-left:20px;
  display:flex;
  flex-direction:column;
  gap:6px;
  font-size:14px;
}

.scenario-meta {
  margin:0;
  font-size:12px;
  color:var(--text-muted);
}

.result-actions {
  display:flex;
  gap:8px;
}

.compare-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:18px;
}

.result-card {
  border-radius:var(--radius-lg);
  border:1px solid var(--border);
  padding:20px;
  background:linear-gradient(180deg,#ffffff 0%,#f9fafb 100%);
  display:flex;
  flex-direction:column;
  gap:16px;
}

.result-card.variant {
  background:linear-gradient(180deg,#ffffff 0%,#fef6ec 100%);
}

.result-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
}

.result-header-main {
  display:flex;
  flex-direction:column;
  gap:4px;
}

.result-flags {
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  justify-content:flex-end;
}

.result-badge {
  display:inline-flex;
  align-items:center;
  gap:4px;
  padding:4px 10px;
  border-radius:999px;
  font-size:12px;
  font-weight:600;
  border:1px solid var(--border);
  background:var(--bg-muted);
  color:var(--text);
}

.result-badge.warning {
  background:rgba(245,158,11,0.15);
  border-color:rgba(245,158,11,0.4);
  color:#b45309;
}

.result-badge.assumption {
  background:rgba(14,165,233,0.15);
  border-color:rgba(14,165,233,0.4);
  color:#0369a1;
}

.result-title {
  margin:0;
  font-size:16px;
}

.result-meta {
  font-size:12px;
  color:var(--text-muted);
}

.result-body {
  display:flex;
  flex-direction:column;
  gap:12px;
}

.result-value {
  font-size:28px;
  font-weight:700;
  color:var(--orange-dark);
}

.result-breakdown {
  display:grid;
  grid-template-columns:repeat(2,minmax(120px,1fr));
  gap:8px 16px;
  margin:0;
}

.result-breakdown dt {
  font-size:12px;
  color:var(--text-muted);
}

.result-breakdown dd {
  margin:4px 0 0 0;
  font-size:14px;
}

.result-delta {
  display:flex;
  flex-direction:column;
  gap:4px;
  padding-top:8px;
  border-top:1px dashed var(--border-strong);
  font-size:13px;
}

.delta-value.positive { color:#16a34a; }
.delta-value.negative { color:#dc2626; }

.sensitivity-summary {
  border-radius:var(--radius-lg);
  border:1px solid var(--border);
  padding:0;
  background:#f9fafb;
  overflow:hidden;
}

.sensitivity-summary .section-header {
  padding:12px 18px;
}

.sensitivity-summary .section-body {
  padding:0 18px 18px;
  gap:12px;
}

.summary-grid {
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:12px;
}

.summary-item {
  display:flex;
  flex-direction:column;
  gap:4px;
}

.summary-label {
  font-size:12px;
  color:var(--text-muted);
}

.summary-value {
  font-weight:600;
}

.donut-section,
.warnings-section,
.assumptions-section {
  border-radius:var(--radius-lg);
  border:1px solid var(--border);
  padding:0;
  background:#ffffff;
  overflow:hidden;
}

.donut-section .section-header,
.warnings-section .section-header,
.assumptions-section .section-header {
  padding:14px 20px;
  margin-bottom:0;
}

.donut-section .section-body,
.warnings-section .section-body,
.assumptions-section .section-body {
  padding:0 20px 20px;
}

.warnings-section .section-body,
.assumptions-section .section-body {
  padding-bottom:16px;
}

.donut-section .section-body {
  gap:20px;
}

.warnings-section .section-body,
.assumptions-section .section-body {
  gap:12px;
}

.warning-groups,
.assumption-groups {
  display:grid;
  gap:16px;
}

.warning-group[hidden],
.assumption-group[hidden] {
  display:none;
}

.warning-title,
.assumption-title {
  margin:0 0 6px 0;
  font-size:13px;
  font-weight:600;
  color:var(--text-muted);
}

.warning-list,
.assumption-list {
  margin:0;
  padding-left:20px;
  list-style:disc;
  color:var(--text);
}

.assumption-list li,
.warning-list li {
  font-size:13px;
  line-height:1.5;
  margin-bottom:6px;
}

.donut-wrapper {
  display:flex;
  align-items:center;
  gap:24px;
  flex-wrap:wrap;
}

.donut-chart {
  width:160px;
  height:160px;
}

.donut-legend {
  list-style:none;
  padding:0;
  margin:0;
  display:flex;
  flex-direction:column;
  gap:12px;
  font-size:13px;
}

.donut-legend li {
  display:flex;
  align-items:center;
  gap:10px;
}

.legend-swatch {
  width:14px;
  height:14px;
  border-radius:4px;
}

.warning-list {
  list-style:none;
  margin:0;
  padding:0;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}

.warning-list li {
  background:#fef3c7;
  border-radius:999px;
  padding:6px 12px;
  font-size:12px;
  color:#92400e;
}

.app-footer {
  padding:24px;
  text-align:center;
  font-size:13px;
  color:var(--text-muted);
}

.app-footer a {
  color:var(--orange-dark);
  text-decoration:none;
}

.app-footer a:hover { text-decoration:underline; }

.modal {
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:40;
}

.modal[hidden] { display:none; }

.modal-backdrop {
  position:absolute;
  inset:0;
  background:rgba(15,23,42,0.45);
}

.modal-content {
  position:relative;
  background:#ffffff;
  border-radius:var(--radius-lg);
  padding:24px;
  width:min(520px,90vw);
  max-height:90vh;
  overflow:auto;
  box-shadow:0 24px 48px rgba(15,23,42,0.35);
}

.modal-header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:12px;
  margin-bottom:12px;
}

.modal-title {
  margin:0;
}

.modal-description {
  font-size:13px;
  color:var(--text-muted);
}

.scenario-list {
  list-style:none;
  margin:16px 0 0 0;
  padding:0;
  display:flex;
  flex-direction:column;
  gap:12px;
}

.scenario-item {
  border:1px solid var(--border);
  border-radius:var(--radius-md);
  padding:14px 16px;
  display:flex;
  justify-content:space-between;
  gap:16px;
  align-items:center;
}

.scenario-item-info {
  display:flex;
  flex-direction:column;
  gap:4px;
}

.scenario-item-name {
  font-weight:600;
}

.scenario-item-date {
  font-size:12px;
  color:var(--text-muted);
}

.scenario-item-actions {
  display:flex;
  gap:8px;
}

.skeleton-block {
  border-radius:var(--radius-md);
  background:linear-gradient(90deg,#f3f4f6 0%,#e5e7eb 50%,#f3f4f6 100%);
  background-size:200% 100%;
  animation:shimmer 1.2s ease-in-out infinite;
}

@keyframes shimmer {
  0% { background-position:0% 0%; }
  100% { background-position:-200% 0%; }
}

.theme-dark {
  background:#0f172a;
  color:#e2e8f0;
}

.theme-dark .app-header {
  background:linear-gradient(90deg,#1e293b,#0f172a);
}

.theme-dark .panel,
.theme-dark .panel-section,
.theme-dark .result-card,
.theme-dark .donut-section,
.theme-dark .source-section,
.theme-dark .warnings-section,
.theme-dark .assumptions-section,
.theme-dark .modal-content {
  background:rgba(15,23,42,0.86);
  color:#e2e8f0;
  border-color:rgba(148,163,184,0.4);
}

.theme-dark .section-toggle-icon {
  background:rgba(30,41,59,0.8);
  border-color:rgba(148,163,184,0.4);
}

.theme-dark .form-control {
  background:rgba(15,23,42,0.8);
  border-color:rgba(148,163,184,0.4);
  color:#e2e8f0;
}

.theme-dark .form-control:focus {
  box-shadow:0 0 0 2px rgba(59,130,246,0.35);
}

.theme-dark .result-card.variant {
  background:linear-gradient(180deg,rgba(15,23,42,0.9) 0%,rgba(30,64,175,0.3) 100%);
}

.theme-dark .result-value { color:#f97316; }

.theme-dark .summary-title,
.theme-dark .summary-label,
.theme-dark .result-meta,
.theme-dark .field-label,
.theme-dark .field-group-title,
.theme-dark .warning-title,
.theme-dark .assumption-title,
.theme-dark .app-subtitle { color:#cbd5f5; }

.theme-dark .field-group {
  background:rgba(15,23,42,0.7);
  border-color:rgba(148,163,184,0.35);
  box-shadow:0 10px 28px rgba(0,0,0,0.35);
}

.theme-dark .field-note,
.theme-dark .warning-list,
.theme-dark .assumption-list {
  color:#e2e8f0;
}

.theme-dark .field-help {
  background:rgba(30,41,59,0.8);
  border-color:rgba(148,163,184,0.35);
  color:#94a3b8;
}

.theme-dark .result-badge {
  background:rgba(30,41,59,0.7);
  border-color:rgba(148,163,184,0.35);
  color:#bfdbfe;
}

.theme-dark .result-badge.warning {
  color:#fbbf24;
  border-color:rgba(251,191,36,0.4);
  background:rgba(251,191,36,0.15);
}

.theme-dark .result-badge.assumption {
  color:#67e8f9;
  border-color:rgba(103,232,249,0.4);
  background:rgba(14,165,233,0.15);
}

.theme-dark .badge { background:rgba(255,255,255,0.12); border-color:rgba(255,255,255,0.25); }

.theme-dark .modal-backdrop { background:rgba(15,23,42,0.7); }

@media (max-width:1200px) {
  .panel-input,
  .panel-results {
    grid-column:span 12;
  }
}

@media (max-width:900px) {
  .app-main {
    padding:24px;
  }
  .panel {
    padding:22px;
  }
}

@media (max-width:720px) {
  .app-header {
    flex-direction:column;
    align-items:flex-start;
  }
  .header-right {
    width:100%;
    justify-content:space-between;
  }
  .sensitivity-row {
    grid-template-columns:100px 1fr 60px 24px;
  }
}

@media (max-width:520px) {
  .app-main { padding:20px 14px; }
  .panel { padding:18px; }
  .field-grid { grid-template-columns:1fr; }
  .result-breakdown { grid-template-columns:1fr; }
  .scenario-buttons { flex-direction:column; align-items:stretch; }
}
